---
export interface Props {
  title: string;
  lang: string;
}

const { title, lang } = Astro.props;

const pathname = Astro.url.href;

let splittedPath = pathname.split("/");

let subPaths = splittedPath.filter(
  (item) => item != "en" && item != "" && item != "br"
);

subPaths.splice(0, 1);

let basePath = Astro.url.origin + "/astro-folio";
let homePath = lang == "br" ? basePath + "/br/" : basePath + "/en/";
const areWeHome =
  pathname == homePath || pathname == basePath || pathname == basePath + "/";
//console.log("Debugg:\n homePath: "+homePath+"\n"+" pathname: "+pathname+"\n"+" basePath with slash: "+basePath+"/"+"\n areWeHome: "+areWeHome); //debugg

let changeLangPath = lang == "br" ? basePath + "/en/" : basePath + "/br/";

for (let i = 2; i < subPaths.length; i++) {
  changeLangPath += subPaths[i] + "/";
}

import { ViewTransitions } from "astro:transitions";
import { ThemeToggle } from "../components/ThemeToggle";
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1"
    />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@600&display=swap"
      rel="stylesheet"
    /> -->
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <ViewTransitions />
  </head>
  <body class="dark">
    <nav class="nav_menu">
      {
        !areWeHome && (
          <a id="homeBtn" href={homePath}>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-4 h-4"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"
              />
            </svg>
          </a>
        )
      }
      <a id="langBtn" href={changeLangPath}
        ><span class={lang == "br" ? "highlight" : "no-highlight"}>BR</span> | <span
          class={lang == "en" ? "highlight" : "no-highlight"}>EN</span
        >
      </a>
      <ThemeToggle />
    </nav>
    <slot />

    <style is:global>
      @font-face {
        font-family: "Fira Code";
        src: url("/fonts/FiraCode-VariableFont_wght.ttf")
          format("woff2-variations");
        font-weight: 300 700; /* Supported weight range */
        font-display: swap;
      }

      * {
        overscroll-behavior: contain;
      }

      .highlight {
        opacity: 0.9;
      }

      .no-highlight {
        opacity: 0.3;
      }

      .nav_menu {
        position: absolute;
        align-items: center;
        left: 0.3rem;
        top: 0;
        margin: 0;
        padding: 0.3rem;
        width: fit-content;
        display: flex;
        flex-direction: row-reverse;
        gap: 0.5rem;
        font-family:
          Fira Code,
          monospace;
        cursor: pointer;
        user-select: none;
        z-index: 999;
      }

      #homeBtn {
        font-size: 1rem;
        text-decoration: none;
        color: white;
      }

      #langBtn {
        font-size: 0.8rem;
        text-decoration: none;
        color: white;
      }

      :root {
        --pallete4aA: #080a1f60; /* deeppurple */
        --pallete4b: #c72e31; /* coolred */
        --pallete4c: #4551c4; /* purpleblue */
        --pallete4cA: #4551c440; /* purplebluealpha */
        --pallete4d: #c4a431; /* mustard */
        --pallete4e: #E6E8F0; /* softwhite */
        --pallete4f: #232e26; /* boardgreen */
      }

      .light {
        --background: 247 248 250;
        --accent: 176 32 35; 
        --primary: 58 70 168; 
        --secondary: 166 133 31; 
        --text: 26 28 43;
        --neutral: 62 91 74;
      }

      .dark {
        --background: 8 10 31;
        --accent: 199 46 49;
        --primary: 69 81 196;
        --secondary: 196 164 49;
        --text: 230 232 240;
        --neutral: 35 46 38;
      }

      html {
        font-family: system-ui, sans-serif;
        margin: 0;
        padding: 0;
        width: 100%;
        min-height: 100%;
        height: fit-content;
        box-sizing: border-box;
      }

      body {
        /* position: fixed; */
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        width: 100%;
        min-height: 100%;
        height: fit-content;
        overflow-y: auto;
        background-color: rgb(var(--background));
      }

      code {
        font-family:
          Menlo,
          Monaco,
          Lucida Console,
          Liberation Mono,
          DejaVu Sans Mono,
          Bitstream Vera Sans Mono,
          Courier New,
          monospace;
      }
    </style>
  </body>
</html>

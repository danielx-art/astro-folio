---
import { FaleComigo } from "../../components/FaleComigo";
import { ProjectLinks } from "../../components/ProjectLinks";
import { ProjectTechs } from "../../components/ProjectTechs";
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

export function getStaticPaths() {
  return [{ params: { lang: "br" } }, { params: { lang: "en" } }];
}

let { lang } = Astro.params;
typeof lang === "string" ? null : (lang = "br");

const projects = await getCollection("projects", ({ id }) => {
  return id.startsWith(lang + "/");
});

const basePath = Astro.url.origin + "/astro-folio";
---

<Layout title="Daniel Folio" lang={lang}>
  <div class="relative min-h-screen text-white pb-8 bg-gradient-to-br from-[#c72e304e] to-transparent">
    <!-- Background texture -->
    <div class="absolute inset-0 bg-texture bg-repeat bg-center opacity-[0.05] mix-blend-overlay pointer-events-none hidden sm:block"></div>

    <!-- Projects -->
    <div class="pt-20 bg-gradient-to-b from-black/60 to-transparent">
      <div class="flex flex-col gap-6 items-center px-4">
        {projects.map((project, index) => (
          <article class="w-full max-w-4xl flex flex-col md:flex-row gap-6 bg-black/50 p-6 rounded-lg">
            <!-- Image and links -->
            <div class="md:w-1/3 flex flex-col gap-4">
              <div class="ring-2 ring-pallete4c rounded-lg overflow-hidden">
                <a href={project.data.link || undefined}>
                  <img
                    src={`${basePath}/projects/thumbs/${index + 1}.png`}
                    class="w-full h-auto object-contain motion-safe:hover:animate-zinzout"
                    alt={project.data.title}
                  />
                </a>
              </div>
              {project.data.link && project.data.github && (
                <div class="flex justify-center">
                  <ProjectLinks
                    link={project.data.link}
                    githubLink={project.data.github}
                  />
                </div>
              )}
            </div>

            <!-- Content -->
            <div class="md:w-2/3 flex flex-col gap-4 justify-center">
              <h2 class="text-2xl md:text-xl font-bold text-pallete4c text-center md:text-left">
                {project.data.title}
              </h2>
              <p class="text-center md:text-left">
                {project.data.description}
              </p>
              <div class="flex justify-center md:justify-start">
                <ProjectTechs
                  techs={project.data.techs}
                  basePath={basePath}
                />
              </div>
            </div>
          </article>
        ))}
      </div>
    </div>
  </div>
</Layout>